(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([["HarbergerTaxBannerPurchaseCTA"],{"./src/reddit/actions/harbergerTax/actionCreators.ts":function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"e",(function(){return d})),r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"d",(function(){return c})),r.d(t,"f",(function(){return u})),r.d(t,"g",(function(){return b})),r.d(t,"h",(function(){return l})),r.d(t,"i",(function(){return m})),r.d(t,"j",(function(){return f}));var n=r("./src/lib/makeActionCreator/index.ts"),s=r("./src/reddit/actions/harbergerTax/constants.ts");const o=Object(n.a)(s.c),d=Object(n.a)(s.e),i=Object(n.a)(s.a),a=Object(n.a)(s.b),c=Object(n.a)(s.d),u=Object(n.a)(s.f),b=Object(n.a)(s.g),l=Object(n.a)(s.h),m=Object(n.a)(s.i),f=Object(n.a)(s.j)},"./src/reddit/components/Governance/HarbergerTax/BannerPurchaseCTA/index.m.less":function(e,t,r){e.exports={container:"oc2hBUbsTl-V_W2CPEsZf",disabled:"_2fJJUTzj7dLnv_DNuenZP9",token:"_3w6edM8masZLL2X9YoWf0A"}},"./src/reddit/components/Governance/HarbergerTax/BannerPurchaseCTA/index.tsx":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/fbt/lib/FbtPublic.js"),s=r("./node_modules/react/index.js"),o=r.n(s),d=r("./node_modules/react-redux/es/index.js"),i=r("./node_modules/reselect/es/index.js"),a=r("./src/lib/classNames/index.ts"),c=r("./src/lib/prettyPrintNumber/index.ts"),u=r("./src/reddit/actions/harbergerTax/actionCreators.ts"),b=r("./src/reddit/actions/tooltip.ts"),l=r("./src/reddit/components/Governance/Token/index.tsx"),m=r("./src/reddit/components/InfoTextTooltip/index.tsx"),f=r("./src/reddit/contexts/PageLayer/index.tsx"),h=r("./src/reddit/featureFlags/component.tsx"),p=r("./src/reddit/helpers/governance/ethereum.ts"),y=r("./src/reddit/helpers/governance/tokens.ts"),g=r("./src/reddit/selectors/gov.ts"),v=r("./src/reddit/components/Governance/HarbergerTax/BannerPurchaseCTA/index.m.less"),w=r.n(v);const x=Object(i.c)({cost:(e,t)=>{const r=Object(f.q)(e,t);if(r)return Object(g.d)(e,{subredditId:r.id})},publicAddress:(e,t)=>{const r=Object(f.q)(e,t),n=e.user.account;if(r&&n){const t=Object(g.i)(e,{subredditId:r.id,userId:n.id});if(t)return t.publicAddress}},subreddit:f.q,tokenDisplayConversion:(e,t)=>{const r=Object(f.q)(e,t)||void 0;return Object(g.n)(e,{subredditId:r&&r.id})},useCrypto:(e,t)=>{const r=Object(f.q)(e,t);return!!r&&Object(g.k)(e,{subredditId:r.id})},userOwnsBanner:(e,t)=>{const r=Object(f.q)(e,t),n=e.user.account;if(r&&n){return Object(g.e)(e,{subredditId:r.id}).ownerId===n.id}return!1}}),j=Object(d.b)(x,e=>({onHideTooltip:()=>e(Object(b.i)()),onOpenManageFlow:(t,r)=>e(r?Object(u.a)({subredditId:t}):Object(u.c)({subredditId:t})),onOpenPurchaseFlow:(t,r)=>e(r?Object(u.b)({subredditId:t}):Object(u.e)({subredditId:t})),onShowTooltip:t=>e(Object(b.f)({tooltipId:t}))})),O=Object(f.t)();t.default=Object(h.a)("spHarberger",O(j((function(e){const{cost:t,publicAddress:r,subreddit:d,useCrypto:i,userOwnsBanner:u,onHideTooltip:b,onOpenManageFlow:f,onOpenPurchaseFlow:h,onShowTooltip:g,tokenDisplayConversion:v}=e;if(!t||!d)return null;const x=Object(p.e)(),j=!u&&i&&(!x||!!!r),O=`harberger-cta-${d.id}`;return o.a.createElement("div",{className:Object(a.a)(w.a.container,{[w.a.disabled]:j}),id:O,onClick:()=>{j||(u?f(d.id,i):h(d.id,i))},onMouseOver:()=>g(O),onMouseOut:b},u?n.fbt._("manage banner",null,{hk:"bVWkT"}):o.a.createElement(s.Fragment,null,n.fbt._("buy banner",null,{hk:"BcYLs"}),o.a.createElement(l.a,{className:w.a.token,subredditId:d.id}),Object(c.a)(Object(y.b)(t,v))),j&&o.a.createElement(m.c,{tooltipId:O,text:x?n.fbt._("You must register your wallet address to purchase the banner",null,{hk:"38o58h"}):n.fbt._("You must have metamask installed to purchase the banner",null,{hk:"3A896M"})}))}))))},"./src/reddit/components/Governance/Token/index.m.less":function(e,t,r){e.exports={grey:"_3oUx7R2UEz3llZLsIONH4x"}},"./src/reddit/components/Governance/Token/index.tsx":function(e,t,r){"use strict";var n=r("./node_modules/react/index.js"),s=r.n(n),o=r("./node_modules/react-redux/es/index.js"),d=r("./node_modules/reselect/es/index.js"),i=r("./src/config.ts"),a=r("./src/lib/classNames/index.ts"),c=r("./src/reddit/selectors/gov.ts"),u=r("./src/reddit/components/Governance/Token/index.m.less"),b=r.n(u);const l=Object(d.c)({tokenSymbol:c.p});t.a=Object(o.b)(l)((function(e){const t=e.grey?e.tokenSymbol.greyVector||e.tokenSymbol.grey:e.tokenSymbol.filledVector||e.tokenSymbol.filled,r=`${i.a.assetPath}/${t}`;if(e.grey&&r.endsWith(".svg")){const t=`url(${r}) center/cover`;return s.a.createElement("div",{className:Object(a.a)(b.a.grey,e.className),style:{mask:t,WebkitMask:t}})}return s.a.createElement("img",{className:e.className,src:r})}))},"./src/reddit/endpoints/governance/crypto.ts":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"i",(function(){return d})),r.d(t,"h",(function(){return i})),r.d(t,"g",(function(){return a})),r.d(t,"j",(function(){return c})),r.d(t,"k",(function(){return u})),r.d(t,"f",(function(){return b})),r.d(t,"c",(function(){return l})),r.d(t,"b",(function(){return m})),r.d(t,"d",(function(){return f})),r.d(t,"e",(function(){return h})),r.d(t,"l",(function(){return p}));var n,s=r("./src/config.ts"),o=r("./src/reddit/endpoints/governance/requester.ts");function d(e){switch(e){case n.Ethereum:case n.EthTraderEthereum:return"Ethereum Main Network";case n.Rinkeby:case n.EthTraderRinkeby:return"Rinkeby Test Network"}return e+" Network"}function i(e){switch(e){case n.Ethereum:case n.EthTraderEthereum:return"https://meta-api.reddit.com/ethereum/ethereum";case n.Rinkeby:case n.EthTraderRinkeby:return"https://meta-api.reddit.com/ethereum/rinkeby"}throw new Error(`No JSON RPC url for provider: ${e}`)}function a(e){switch(e){case n.Ethereum:case n.EthTraderEthereum:return"homestead";case n.Rinkeby:case n.EthTraderRinkeby:return"rinkeby"}throw new Error(`No ethereum network for provider: ${e}`)}async function c(e,t,r){return Object(o.a)(e,{method:"post",endpoint:`${s.a.metaUrl}/crypto/${t}/challenges`,data:{challengeType:"registration-challenge-EIP712",address:r}})}async function u(e,t,r){return await Object(o.a)(e,{method:"post",endpoint:`${s.a.metaUrl}/crypto/${t}/registrations`,data:r})}async function b(e,t,r){return await Object(o.a)(e,{method:"delete",endpoint:`${s.a.metaUrl}/crypto/${t}/registrations/${r}`})}!function(e){e.Ethereum="ethereum:1",e.Rinkeby="ethereum:4",e.EthTraderEthereum="ethereum:1:ethtrader",e.EthTraderRinkeby="ethereum:4:ethtrader",e.Stellar="stellar"}(n||(n={}));const l=e=>({type:"convert-to-coins",subredditId:e}),m=e=>({type:"claim",subredditId:e}),f=e=>({type:"subscribe",subredditId:e}),h=(e,t,r,n)=>({type:"transfer",subredditId:e,recipient:t,recipientAddress:r,amount:n});async function p(e,t){return await Object(o.a)(e,{method:"put",endpoint:`${s.a.metaUrl}/crypto/ethereum/transaction-intent`,data:t})}},"./src/reddit/helpers/governance/ethereum.ts":function(e,t,r){"use strict";r.d(t,"e",(function(){return o})),r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return c})),r.d(t,"f",(function(){return m})),r.d(t,"g",(function(){return h})),r.d(t,"h",(function(){return p})),r.d(t,"i",(function(){return y}));r("./node_modules/core-js/modules/web.dom.iterable.js");var n=r("./node_modules/fbt/lib/FbtPublic.js");function s(){return window.ethereum}function o(){const e=s();return!(!e||!e.isMetaMask)}function d(){const e=s();return e&&e.selectedAddress||null}function i(){return s().networkVersion||null}function a(){const e=s();if(!e)throw new Error("Please install a web3 provider, such as MetaMask");return d()?Promise.resolve():e.enable()}const c=4001;async function u(e,t,n,o){const[d,i]=await Promise.all([r.e("vendors~CryptoLibEthers~reddit-components-Governance-TransactionModals-ClaimPointsModal~reddit-compo~89877e6b").then(r.t.bind(null,"./node_modules/ethers/dist/ethers.min.js",7)).then(e=>e.ethers),t.then(e=>e.abi)]);await a();const c=new d.providers.Web3Provider(s()).getSigner(),u=new d.Contract(e,i,c),b=await u[n](...o);return await b.wait()}const b={abi:[{constant:!1,inputs:[{name:"to",type:"address"},{name:"value",type:"uint256"},{name:"data",type:"bytes"}],name:"send",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"}]};const l=1;async function m(e,t,n,s,o){const d=await r.e("vendors~CryptoLibEthers~reddit-components-Governance-TransactionModals-ClaimPointsModal~reddit-compo~89877e6b").then(r.t.bind(null,"./node_modules/ethers/dist/ethers.min.js",7)).then(e=>e.ethers),{bigNumberify:i,hexlify:a,hexZeroPad:c,toUtf8Bytes:m}=d.utils,f=i(n).add(o),h=l,p="0x"+[a(1)].concat([h,i(s),i(o)].map(a).map(e=>c(e,32))).concat(a(m(""))).map(e=>e.substr(2)).join("");return async function(e,t,r,n){return u(e,Promise.resolve(b),"send",[t,r,n])}(e,t,f.toString(),p)}const f={abi:[{constant:!1,inputs:[{name:"_subscriber",type:"address"},{name:"_units",type:"uint16"}],name:"subscribe",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"}]};async function h(e,t,r){await a();const s=d()||"";if(t.toLowerCase()!==s.toLowerCase())throw new Error(n.fbt._("Please select your registered address in MetaMask: {subscriberAddress}",[n.fbt._param("subscriberAddress",t)],{hk:"3rehSL"}).toString());return u(e,Promise.resolve(f),"subscribe",[t,r])}function p(e){const t=s();return new Promise((r,s)=>{const o=JSON.stringify(e);t.sendAsync({method:"eth_signTypedData_v3",params:[t.selectedAddress,o],from:t.selectedAddress},(e,t)=>{if(e)s(e);else{const e=t&&t.result;e?r(e):s({message:n.fbt._("No signature returned from ethereum provider.",null,{hk:"eiYBF"}).toString()})}})})}function y(e){return new Promise((t,r)=>{s().sendAsync({method:"metamask_watchAsset",params:{type:"ERC20",options:e},id:Math.round(1e5*Math.random())},(e,n)=>{e||"error"in n?r("There was an error tracking the token"):t()})})}},"./src/reddit/helpers/governance/tokens.ts":function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return d})),r.d(t,"a",(function(){return i}));var n=r("./node_modules/bignumber.js/bignumber.js"),s=r("./src/lib/prettyPrintNumber/index.ts");function o(e,t){const r=new n.BigNumber(e),s=new n.BigNumber(t);return r.dividedToIntegerBy(s).toString()}function d(e,t){return Object(s.b)(parseInt(o(e,t),10))}function i(e,t){const r=new n.BigNumber(e),s=new n.BigNumber(t);return r.multipliedBy(s).toFixed(0)}},"./src/reddit/selectors/gov.ts":function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return b})),r.d(t,"g",(function(){return l})),r.d(t,"r",(function(){return m})),r.d(t,"h",(function(){return f})),r.d(t,"i",(function(){return h})),r.d(t,"j",(function(){return p})),r.d(t,"o",(function(){return y})),r.d(t,"p",(function(){return g})),r.d(t,"n",(function(){return v})),r.d(t,"l",(function(){return x})),r.d(t,"s",(function(){return j})),r.d(t,"a",(function(){return O})),r.d(t,"f",(function(){return k})),r.d(t,"q",(function(){return T})),r.d(t,"m",(function(){return _})),r.d(t,"k",(function(){return E}));var n=r("./src/reddit/contexts/PageLayer/index.tsx"),s=r("./src/reddit/endpoints/governance/crypto.ts");const o=[],d={},i={filled:"img/communityPoints/default_filled.png",grey:"img/communityPoints/default_grey.png"},a=(e,{subredditId:t})=>{const r=j(e,{subredditId:t});return r&&r.extra&&r.extra.contracts&&r.extra.contracts.harberger?r.extra.contracts.harberger:{address:void 0,decimals:void 0,image:void 0,taxRate:.01,token:void 0}},c=(e,t)=>{const r=w(e,t);if(r)return r.mainHeader},u=(e,t)=>{const r=w(e,t);return r&&r.mainHeader?r.mainHeader.price:"0"},b=(e,t)=>{const r=w(e,t);return r&&r.mainHeader?{owner:r.mainHeader.owner,ownerId:r.mainHeader.ownerId}:d},l=(e,t)=>t&&t.subredditId?(e.user.wallets[t.subredditId]||{}).latest:void 0,m=(e,t)=>{const r=l(e,t),n=r&&r.publicAddress;if(!n)throw new Error("No wallet address found");return n},f=(e,t)=>{const r=l(e,t);return r&&r.amount||"0"},h=(e,t)=>{return(e.users.publicWallets[t.userId]||{})[t.subredditId]},p=(e,t)=>{const r=Object(n.m)(e,t);return r&&e.subreddits.gov.releaseNotes[r]||o},y=(e,t)=>t&&t.subredditId&&(e.subreddits.gov.meta[t.subredditId]||{}).name||"Subreddit Points",g=(e,t)=>t&&t.subredditId&&(e.subreddits.gov.meta[t.subredditId]||{}).images||i,v=(e,t)=>{const r=T(e,t);return r&&r.decimals?"1"+"0".repeat(r.decimals):"1"},w=(e,t)=>t.subredditId?e.subreddits.gov.assets[t.subredditId]:void 0,x=(e,t)=>t&&t.subredditId?e.subreddits.gov.meta[t.subredditId]:void 0,j=(e,t)=>{const r=x(e,t);return r&&r.walletProvider},O=(e,t)=>{const r=j(e,t),n=x(e,t);return r&&r.provider||n&&n.provider},k=(e,t)=>{const r=O(e,t);return r===s.a.Ethereum||r===s.a.Rinkeby||r===s.a.EthTraderEthereum||r===s.a.EthTraderRinkeby},T=(e,t)=>{const r=j(e,t),n=O(e,t);if(r&&!r.inTransition&&n===s.a.Stellar)return{address:r.extra&&r.extra.issuerAddress||"",decimals:r.extra&&r.extra.decimals||7,symbol:r.extra&&r.extra.token||"PHOTON"};const o=r&&r.extra&&r.extra.contracts,d=o&&o.unlocked;return d&&{address:d.address,symbol:d.token||"",decimals:d.decimals||18,image:d.image}},_=(e,{subredditId:t})=>{const r=j(e,{subredditId:t});return r&&r.extra&&r.extra.contracts&&r.extra.contracts.subscriptions?r.extra.contracts.subscriptions:{address:void 0}},E=(e,t)=>{const r=x(e,t);return!!r&&!!r.walletProvider&&!r.walletProvider.inTransition}}}]);
//# sourceMappingURL=https://www.redditstatic.com/desktop2x/HarbergerTaxBannerPurchaseCTA.7e62c7a27f751e6ada53.js.map