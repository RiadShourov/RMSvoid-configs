(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([["GovernanceUserPublicPointsDisplay"],{"./src/graphql/operations/PollVote.json":function(e){e.exports=JSON.parse('{"id":"a20cc8dd230d"}')},"./src/lib/bigNumberUtils/percent.ts":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("./node_modules/bignumber.js/bignumber.js");function s(e,t){const r=new n.BigNumber(e),s=new n.BigNumber(t),o=new n.BigNumber(r.dividedBy(s)),d=new n.BigNumber("100").multipliedBy(o);return new n.BigNumber(d).toNumber()}},"./src/reddit/actions/governance/constants.ts":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return d})),r.d(t,"e",(function(){return i})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return a})),r.d(t,"h",(function(){return u})),r.d(t,"i",(function(){return l})),r.d(t,"j",(function(){return b})),r.d(t,"k",(function(){return m})),r.d(t,"l",(function(){return f})),r.d(t,"m",(function(){return p})),r.d(t,"n",(function(){return E})),r.d(t,"o",(function(){return _})),r.d(t,"p",(function(){return O})),r.d(t,"q",(function(){return N})),r.d(t,"r",(function(){return g})),r.d(t,"s",(function(){return x})),r.d(t,"t",(function(){return I})),r.d(t,"u",(function(){return h})),r.d(t,"v",(function(){return y})),r.d(t,"w",(function(){return j})),r.d(t,"x",(function(){return T}));const n="GOVERNANCE__COMMUNITY_DETAILS_SUCCESS",s="GOVERNANCE__NEW_SUBREDDIT_SUGGESTED",o="GOVERNANCE__NEW_TOP_MOD_SUGGESTED",d="GOVERNANCE__OPT_OUT_MODAL_OPENED",i="POLL_VOTE_SUCCESS",c="GOVERNANCE__PROPOSAL_CREATION_FAILURE",a="GOVERNANCE__PROPOSAL_CREATION_PENDING",u="GOVERNANCE__PROPOSAL_CREATION_SUCCESS",l="GOVERNANCE__PROPOSAL_OPTION_VOTE_FAILURE",b="GOVERNANCE__PROPOSAL_OPTION_VOTE_PENDING",m="GOVERNANCE__PROPOSAL_OPTION_VOTE_SUCCESS",f="GOVERNANCE__PUBLIC_WALLET_INFO_FAILURE",p="GOVERNANCE__PUBLIC_WALLET_INFO_PENDING",E="GOVERNANCE__PUBLIC_WALLET_INFO_SUCCESS",_="GOVERNANCE__RELEASE_NOTES_MODAL_OPENED",O="GOVERNANCE__RELEASE_NOTES_SUCCESS",N="GOVERNANCE__TRANSFER_FAILURE",g="GOVERNANCE__TRANSFER_MODAL_OPENED",x="GOVERNANCE__TRANSFER_PENDING",I="GOVERNANCE__TRANSFER_SUCCESS",h="GOVERNANCE__WALLETS_FETCH_FAILURE",y="GOVERNANCE__WALLETS_FETCH_PENDING",j="GOVERNANCE__WALLETS_FETCH_SUCCESS",T="GOVERNANCE__WALLET_REGISTRATION_MODAL_OPENED"},"./src/reddit/actions/governance/errorToast.ts":function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r("./src/reddit/actions/toaster.ts"),s=r("./src/reddit/helpers/governanceErrorText/index.ts"),o=r("./src/reddit/models/Toast/index.ts");function d(e,t){e(Object(n.e)({duration:5e3,kind:o.b.Error,text:Object(s.a)(t)}))}},"./src/reddit/actions/governance/index.ts":function(e,t,r){"use strict";r.d(t,"a",(function(){return g})),r.d(t,"b",(function(){return x})),r.d(t,"c",(function(){return h})),r.d(t,"f",(function(){return k})),r.d(t,"g",(function(){return w})),r.d(t,"d",(function(){return G})),r.d(t,"e",(function(){return L})),r.d(t,"h",(function(){return U}));var n=r("./node_modules/fbt/lib/FbtPublic.js"),s=r("./src/lib/makeActionCreator/index.ts"),o=r("./src/lib/prettyPrintNumber/index.ts"),d=r("./src/reddit/actions/modal.ts"),i=r("./src/reddit/actions/post.ts"),c=r("./src/reddit/actions/toaster.ts"),a=r("./src/config.ts"),u=r("./src/graphql/operations/PollVote.json"),l=r("./src/lib/makeGqlRequest/index.ts"),b=r("./src/reddit/models/Poll/index.ts"),m=r("./src/reddit/endpoints/governance/requester.ts");var f=r("./src/reddit/endpoints/governance/wallet.ts"),p=r("./src/reddit/models/Toast/index.ts"),E=r("./src/reddit/models/Vote/index.ts"),_=r("./src/reddit/selectors/gov.ts"),O=r("./src/reddit/actions/governance/constants.ts"),N=r("./src/reddit/actions/governance/errorToast.ts");const g=Object(s.a)(O.b),x=Object(s.a)(O.c),I=Object(s.a)(O.e),h=(Object(s.a)(O.f),Object(s.a)(O.g),Object(s.a)(O.h)),y=Object(s.a)(O.i),j=Object(s.a)(O.j),T=Object(s.a)(O.k),v=Object(s.a)(O.q),k=Object(s.a)(O.r),A=Object(s.a)(O.s),S=Object(s.a)(O.t),R=Object(s.a)(O.u),P=Object(s.a)(O.v),C=Object(s.a)(O.w),w=Object(s.a)(O.x),G=(e,t)=>async(r,n,{apiContext:s,gqlContext:o})=>{let d,c=n().polls.models[e];if(r(j({pollId:e})),(d=c.type===b.a.GA?await((e,t,r)=>Object(l.a)(e,{...u,variables:{input:{postId:t,optionId:r}}}))(o(),e,t):await function(e,t,r,n){return Object(m.a)(e,{method:"put",endpoint:`${a.a.metaUrl}/polls/${t}/${r}/votes/me/${n}`})}(s(),c.subredditId,e,t)).ok){if(c.type===b.a.GA){const{options:e}=d.body.data.updatePostPollVoteState.poll;r(I({pollId:c.id,optionId:t,options:e}))}else r(T(d.body));const s=n();if((c=s.polls.models[e])&&Object(b.d)(c)){const{postId:e}=c,t=s.posts.models[e];t&&t.voteState===E.a.notVoted&&r(Object(i.U)(e))}}else r(y({pollId:e,error:d.error||d.errors[0].message})),Object(N.a)(r,d.error||d.errors[0].messsage)},L=(e,t)=>async(r,s,{apiContext:i})=>{r(A());const u=s().transfers.communityPoints.contentId||void 0,l=await function(e,t){return Object(m.a)(e,{data:{amount:t.amount,contentId:t.contentId,description:t.message,receiveUserName:t.recipient},endpoint:`${a.a.metaUrl}/wallets/me/${t.subredditId}/transfers`,method:"post"})}(i(),{...e,contentId:u});l.ok?(r(S({...l.body,subredditId:e.subredditId})),r(Object(c.e)({kind:p.b.SuccessCommunity,text:n.fbt._("Success! You just transferred {amount} {tokenName} to {recipient}",[n.fbt._param("amount",Object(o.a)(e.amount)),n.fbt._param("tokenName",Object(_.o)(s(),{subredditId:e.subredditId})),n.fbt._param("recipient",e.recipient)],{hk:"3klrhq"})})),t&&r(Object(d.f)())):(r(v({error:l.error})),Object(N.a)(r,l.error))},U=e=>async(t,r,{apiContext:n})=>{t(P());const s=await Object(f.a)(n(),e);s.ok?t(C(s.body)):t(R({error:s.error}))}},"./src/reddit/components/Governance/Token/index.m.less":function(e,t,r){e.exports={grey:"_3oUx7R2UEz3llZLsIONH4x"}},"./src/reddit/components/Governance/Token/index.tsx":function(e,t,r){"use strict";var n=r("./node_modules/react/index.js"),s=r.n(n),o=r("./node_modules/react-redux/es/index.js"),d=r("./node_modules/reselect/es/index.js"),i=r("./src/config.ts"),c=r("./src/lib/classNames/index.ts"),a=r("./src/reddit/selectors/gov.ts"),u=r("./src/reddit/components/Governance/Token/index.m.less"),l=r.n(u);const b=Object(d.c)({tokenSymbol:a.p});t.a=Object(o.b)(b)((function(e){const t=e.grey?e.tokenSymbol.greyVector||e.tokenSymbol.grey:e.tokenSymbol.filledVector||e.tokenSymbol.filled,r=`${i.a.assetPath}/${t}`;if(e.grey&&r.endsWith(".svg")){const t=`url(${r}) center/cover`;return s.a.createElement("div",{className:Object(c.a)(l.a.grey,e.className),style:{mask:t,WebkitMask:t}})}return s.a.createElement("img",{className:e.className,src:r})}))},"./src/reddit/components/Governance/UserPublicPointsDisplay/index.m.less":function(e,t,r){e.exports={token:"_3nQr7AT1U0w1HdVk-xepUB",tokenFilled:"_3d-Rpbq-Qb88tf5D_s1rsj",tokenGrey:"pvn75ouWnsoKK4l_QS9yI",amount:"_3nhTfmUMmYib8x61No0h3r",container:"_15KjTxLhBmrJE79nlBUuxb",tippable:"_2pUuGtsqXDTCxGGGGr-NXT"}},"./src/reddit/components/Governance/UserPublicPointsDisplay/index.tsx":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/fbt/lib/FbtPublic.js"),s=r("./node_modules/react/index.js"),o=r.n(s),d=r("./node_modules/react-redux/es/index.js"),i=r("./node_modules/reselect/es/index.js"),c=r("./src/lib/classNames/index.ts"),a=r("./src/reddit/actions/governance/index.ts"),u=r("./src/reddit/actions/tooltip.ts"),l=r("./src/reddit/components/Governance/Token/index.tsx"),b=r("./src/reddit/components/InfoTextTooltip/index.tsx"),m=r("./src/reddit/featureFlags/index.ts"),f=r("./src/reddit/featureFlags/component.tsx"),p=r("./src/reddit/helpers/governance/tokens.ts"),E=r("./src/reddit/selectors/economics.ts"),_=r("./src/reddit/selectors/gov.ts"),O=r("./src/reddit/components/Governance/UserPublicPointsDisplay/index.m.less"),N=r.n(O);const g=Object(i.c)({publicWallet:_.i,tippingEnabled:m.d.spTipping,tokenDisplayConversion:_.n,tokenName:_.o,useCrypto:_.k,userOptedOut:(e,{subredditId:t})=>Object(E.x)(e,t)});t.default=Object(f.a)("spPublicPoints",Object(d.b)(g,e=>({onHideTooltip:()=>e(Object(u.i)()),onShowTooltip:t=>e(Object(u.f)({tooltipId:t})),onTip:(t,r,n)=>e(Object(a.f)({recipient:t,contentId:r,publicAddress:n}))}))((function(e){if(e.userOptedOut)return null;const{contentId:t,metaSeparator:r,publicWallet:s,subredditId:d,tippingEnabled:i,tokenDisplayConversion:a,tokenName:u,useCrypto:m,username:f}=e,E=s&&s.amount||void 0;if(!E)return null;const _=`public-wallets-${f}-${d}-${t}`,O=s&&s.publicAddress;if(m&&!O)return null;const g=Object(p.c)(E,a);return o.a.createElement("div",{className:Object(c.a)(e.className,N.a.container,{[N.a.tippable]:i}),id:_,onClick:t=>{i&&(t.stopPropagation(),e.onTip(e.username,e.contentId,O))},onMouseEnter:()=>e.onShowTooltip(_),onMouseLeave:()=>e.onHideTooltip(),title:i?"":n.fbt._("{username} has {amount} {token name}",[n.fbt._param("username",e.username),n.fbt._param("amount",g),n.fbt._param("token name",u)],{hk:"6WL3V"})},o.a.createElement(l.a,{className:N.a.tokenFilled,subredditId:e.subredditId}),o.a.createElement(l.a,{grey:!0,className:N.a.tokenGrey,subredditId:e.subredditId}),o.a.createElement("span",{className:N.a.amount},g),r,i&&o.a.createElement(b.c,{caretOnTop:!0,tooltipId:_,text:n.fbt._("Tip {username} with {tokenname}",[n.fbt._param("username",e.username),n.fbt._param("tokenname",u)],{hk:"2Raj4F"})}))})))},"./src/reddit/endpoints/governance/crypto.ts":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"i",(function(){return d})),r.d(t,"h",(function(){return i})),r.d(t,"g",(function(){return c})),r.d(t,"j",(function(){return a})),r.d(t,"k",(function(){return u})),r.d(t,"f",(function(){return l})),r.d(t,"c",(function(){return b})),r.d(t,"b",(function(){return m})),r.d(t,"d",(function(){return f})),r.d(t,"e",(function(){return p})),r.d(t,"l",(function(){return E}));var n,s=r("./src/config.ts"),o=r("./src/reddit/endpoints/governance/requester.ts");function d(e){switch(e){case n.Ethereum:case n.EthTraderEthereum:return"Ethereum Main Network";case n.Rinkeby:case n.EthTraderRinkeby:return"Rinkeby Test Network"}return e+" Network"}function i(e){switch(e){case n.Ethereum:case n.EthTraderEthereum:return"https://meta-api.reddit.com/ethereum/ethereum";case n.Rinkeby:case n.EthTraderRinkeby:return"https://meta-api.reddit.com/ethereum/rinkeby"}throw new Error(`No JSON RPC url for provider: ${e}`)}function c(e){switch(e){case n.Ethereum:case n.EthTraderEthereum:return"homestead";case n.Rinkeby:case n.EthTraderRinkeby:return"rinkeby"}throw new Error(`No ethereum network for provider: ${e}`)}async function a(e,t,r){return Object(o.a)(e,{method:"post",endpoint:`${s.a.metaUrl}/crypto/${t}/challenges`,data:{challengeType:"registration-challenge-EIP712",address:r}})}async function u(e,t,r){return await Object(o.a)(e,{method:"post",endpoint:`${s.a.metaUrl}/crypto/${t}/registrations`,data:r})}async function l(e,t,r){return await Object(o.a)(e,{method:"delete",endpoint:`${s.a.metaUrl}/crypto/${t}/registrations/${r}`})}!function(e){e.Ethereum="ethereum:1",e.Rinkeby="ethereum:4",e.EthTraderEthereum="ethereum:1:ethtrader",e.EthTraderRinkeby="ethereum:4:ethtrader",e.Stellar="stellar"}(n||(n={}));const b=e=>({type:"convert-to-coins",subredditId:e}),m=e=>({type:"claim",subredditId:e}),f=e=>({type:"subscribe",subredditId:e}),p=(e,t,r,n)=>({type:"transfer",subredditId:e,recipient:t,recipientAddress:r,amount:n});async function E(e,t){return await Object(o.a)(e,{method:"put",endpoint:`${s.a.metaUrl}/crypto/ethereum/transaction-intent`,data:t})}},"./src/reddit/endpoints/governance/wallet.ts":function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return i}));var n=r("./src/config.ts"),s=(r("./src/lib/bigNumberUtils/percent.ts"),r("./src/lib/constants/index.ts")),o=r("./src/reddit/endpoints/governance/requester.ts");function d(e,t){return Object(o.a)(e,{endpoint:`${n.a.metaUrl}/wallets/${t.subredditId}/me`,method:s.cb.GET}).then(e=>{if(e.ok){const r=e.body,n={[t.subredditId]:r};return{...e,body:n}}return e})}function i(e,t){return Object(o.a)(e,{headers:{"X-HTTP-Method-Override":"GET"},endpoint:`${n.a.metaUrl}/wallets/${t.subredditId}`,method:s.cb.POST,data:t.userIds}).then(e=>e.ok?{...e,body:{wallets:e.body}}:e)}},"./src/reddit/featureFlags/component.tsx":function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r("./node_modules/react/index.js"),s=r.n(n),o=r("./node_modules/react-redux/es/index.js"),d=r("./node_modules/reselect/es/index.js"),i=r("./src/reddit/featureFlags/index.ts");function c(e,t,r){const n=Object(d.c)({featureEnabled:t=>i.d[e](t)});return Object(o.b)(n)(e=>{const{featureEnabled:n,...o}=e,d=o;return n?s.a.createElement(t,d):void 0!==r?s.a.createElement(r,d):null})}},"./src/reddit/helpers/governance/tokens.ts":function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return d})),r.d(t,"a",(function(){return i}));var n=r("./node_modules/bignumber.js/bignumber.js"),s=r("./src/lib/prettyPrintNumber/index.ts");function o(e,t){const r=new n.BigNumber(e),s=new n.BigNumber(t);return r.dividedToIntegerBy(s).toString()}function d(e,t){return Object(s.b)(parseInt(o(e,t),10))}function i(e,t){const r=new n.BigNumber(e),s=new n.BigNumber(t);return r.multipliedBy(s).toFixed(0)}},"./src/reddit/helpers/governanceErrorText/index.ts":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return d}));r("./node_modules/core-js/modules/web.dom.iterable.js");var n=r("./node_modules/fbt/lib/FbtPublic.js");function s(e){return e[0].toUpperCase()+e.slice(1)}function o(e){return"extra"in e?"string"==typeof e.extra?e.extra:Object.keys(e.extra).map(t=>e.extra[t]).map(s).join(" "):n.fbt._("Something went wrong. Please try again later.",null,{hk:"16ibYk"})}function d(e){const t=`${e.type} (${e.code})`;return"message"in e?`${t}: ${e.message}`:t}},"./src/reddit/selectors/gov.ts":function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return l})),r.d(t,"g",(function(){return b})),r.d(t,"r",(function(){return m})),r.d(t,"h",(function(){return f})),r.d(t,"i",(function(){return p})),r.d(t,"j",(function(){return E})),r.d(t,"o",(function(){return _})),r.d(t,"p",(function(){return O})),r.d(t,"n",(function(){return N})),r.d(t,"l",(function(){return x})),r.d(t,"s",(function(){return I})),r.d(t,"a",(function(){return h})),r.d(t,"f",(function(){return y})),r.d(t,"q",(function(){return j})),r.d(t,"m",(function(){return T})),r.d(t,"k",(function(){return v}));var n=r("./src/reddit/contexts/PageLayer/index.tsx"),s=r("./src/reddit/endpoints/governance/crypto.ts");const o=[],d={},i={filled:"img/communityPoints/default_filled.png",grey:"img/communityPoints/default_grey.png"},c=(e,{subredditId:t})=>{const r=I(e,{subredditId:t});return r&&r.extra&&r.extra.contracts&&r.extra.contracts.harberger?r.extra.contracts.harberger:{address:void 0,decimals:void 0,image:void 0,taxRate:.01,token:void 0}},a=(e,t)=>{const r=g(e,t);if(r)return r.mainHeader},u=(e,t)=>{const r=g(e,t);return r&&r.mainHeader?r.mainHeader.price:"0"},l=(e,t)=>{const r=g(e,t);return r&&r.mainHeader?{owner:r.mainHeader.owner,ownerId:r.mainHeader.ownerId}:d},b=(e,t)=>t&&t.subredditId?(e.user.wallets[t.subredditId]||{}).latest:void 0,m=(e,t)=>{const r=b(e,t),n=r&&r.publicAddress;if(!n)throw new Error("No wallet address found");return n},f=(e,t)=>{const r=b(e,t);return r&&r.amount||"0"},p=(e,t)=>{return(e.users.publicWallets[t.userId]||{})[t.subredditId]},E=(e,t)=>{const r=Object(n.m)(e,t);return r&&e.subreddits.gov.releaseNotes[r]||o},_=(e,t)=>t&&t.subredditId&&(e.subreddits.gov.meta[t.subredditId]||{}).name||"Subreddit Points",O=(e,t)=>t&&t.subredditId&&(e.subreddits.gov.meta[t.subredditId]||{}).images||i,N=(e,t)=>{const r=j(e,t);return r&&r.decimals?"1"+"0".repeat(r.decimals):"1"},g=(e,t)=>t.subredditId?e.subreddits.gov.assets[t.subredditId]:void 0,x=(e,t)=>t&&t.subredditId?e.subreddits.gov.meta[t.subredditId]:void 0,I=(e,t)=>{const r=x(e,t);return r&&r.walletProvider},h=(e,t)=>{const r=I(e,t),n=x(e,t);return r&&r.provider||n&&n.provider},y=(e,t)=>{const r=h(e,t);return r===s.a.Ethereum||r===s.a.Rinkeby||r===s.a.EthTraderEthereum||r===s.a.EthTraderRinkeby},j=(e,t)=>{const r=I(e,t),n=h(e,t);if(r&&!r.inTransition&&n===s.a.Stellar)return{address:r.extra&&r.extra.issuerAddress||"",decimals:r.extra&&r.extra.decimals||7,symbol:r.extra&&r.extra.token||"PHOTON"};const o=r&&r.extra&&r.extra.contracts,d=o&&o.unlocked;return d&&{address:d.address,symbol:d.token||"",decimals:d.decimals||18,image:d.image}},T=(e,{subredditId:t})=>{const r=I(e,{subredditId:t});return r&&r.extra&&r.extra.contracts&&r.extra.contracts.subscriptions?r.extra.contracts.subscriptions:{address:void 0}},v=(e,t)=>{const r=x(e,t);return!!r&&!!r.walletProvider&&!r.walletProvider.inTransition}}}]);
//# sourceMappingURL=https://www.redditstatic.com/desktop2x/GovernanceUserPublicPointsDisplay.22f56dc180e8bb9dd707.js.map